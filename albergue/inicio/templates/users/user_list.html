<title>{%block titulo%} Seguridad {%endblock%}</title>
{% load static %} 

<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
{% block head_extra %}
<link rel="stylesheet" href="{% static 'inicio/css/login_styles.css' %}" />
{% endblock %}

{% block nav %}
<div class="header">
    <h1> </h1>
    <div class="header-right">
        <a href="{% url 'lista_pacientes' %}" style="text-decoration:none;">PACIENTES</a>
        <a href="{% url 'medicamentos' %}" style="text-decoration:none;">MEDICAMENTOS</a>
        {% if user.is_staff %}
        <a href="{% url 'inventario' %}" style="text-decoration:none;">INVENTARIO</a>
        <a href="{% url 'lista_tipos' %}" style="text-decoration:none;">RECURSOS NO MEDICOS </a>
        <a href="{% url 'user_list' %}" style="text-decoration:none;">ADMINISTRAR USUARIOS</a>
        {% endif %}
        <a href="{% url 'logout' %}" style="text-decoration:none;">CERRAR SESIÓN</a>
    </div>
</div>
{% endblock %}

{% block contenido %}

<div class="fade-in">
  <br>
  <h2>Seguridad y Accesos</h2>
  <div class="search-and-button">
      <a href="{% url 'user_create' %}" class="btn-black">Crear nuevo usuario</a>
  </div>

  <table class="user-table">
      <thead>
          <tr>
              <th>Usuario</th>
              <th>Email</th>
              <th>Staff</th>
              <th>Acciones</th>
          </tr>
      </thead>
      <tbody>
          {% for user in users %}
          <tr>
              <td>{{ user.username }}</td>
              <td>{{ user.email }}</td>
              <td>{% if user.is_staff %}Sí{% else %}No{% endif %}</td>
              <td>
                  <div class="action-buttons">
                      <a href="{% url 'user_edit' user.id %}" class="btn-gray">Editar</a>
                      <a href="{% url 'user_delete' user.id %}" class="btn-red">Eliminar</a>
                  </div>
              </td>
          </tr>
          {% empty %}
          <tr>
              <td colspan="4">No hay usuarios registrados.</td>
          </tr>
          {% endfor %}
      </tbody>
  </table>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const links = document.querySelectorAll("a");

  links.forEach(link => {
    link.addEventListener("click", function(e) {
      const href = this.getAttribute("href");
      if (href && !href.startsWith("#") && !this.hasAttribute("data-no-anim")) {
        e.preventDefault();
        document.body.classList.add("fade-out");
        setTimeout(() => {
          window.location.href = href;
        }, 300);
      }
    });
  });
});
</script>

{% endblock %}
